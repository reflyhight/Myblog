
title: cron表达式
tags: 
	- Java
	- Expression

categories:
	- 综合
------------


##    简介
cron表达式（cronExpression）是一个字符串，字符串由6个或者7个字段组成，字段之间用空格隔开，用来表示执行器触发执行的规则，使用cronExpression的任务会按照表达式指定的时间触发执行。比如Spring-Task中用到的定时任务配置中的`cron="0 0 7 * * ?"`如下:
```
    <task:scheduled-tasks>  
        <task:scheduled ref="idMaintain" method="maintain" cron="0 0 7 * * ?"/>
    </task:scheduled-tasks>   
```
##   字段含义
字段从左至右，按序说明如下：

|  第几个字段      |    字段含义 |  可以选择值  | 补充说明 |
| :-------- |: -------- |: -------- |
| 第1个字段 | 秒 | 0-59 , - * / | |
| 第2个字段 | 分 | 0-59 , - * / | |
| 第3个字段 | 小时 | 0-23 , - * / | |
| 第4个字段 | 日期（day-of-month） | 1-31 , - * ? / L W C | |
| 第5个字段 | 月份（moth-of-year） | JAN-DEC , - * / | `JAN`表示方法为月份缩写，表示`1月` |
| 第6个字段 | 星期（day-of-week） | SUN-SAT , - * ? / L C # | `SUN`表示星期缩写，表示`周日` |
| 第7个字段 | 年 | 1970-2099 , - * / | `本字段可以没有` |
 
##    可选值的含义
###    普通数值
普通数值代表该字段的值为该普通数值。
###    特殊字符
 
- `*`：表示所有值；
- `?`：表示未说明的值，即不关心它为何值；
- `-`：表示一个指定的范围；
- `,`：表示附加一个可能值；
- `/`：符号前表示开始时间，符号后表示每次递增的值；
- `L`：("last") "L" 用在`日期`字段意思是 "这个月最后一天"；用在 `星期`字段, 它简单意思是 "7" or "SAT"。 如果在`星期`字段里和数字联合使用，它的意思就是 "这个月的最后一个星期几" – 例如： "6L" means "这个月的最后一个星期五". 当我们用“L”时。
- `W`：只能用在`日期`字段。用来描叙最接近指定天的工作日（周一到周五）。例如：在`日期`字段用“15W”指“最接近这个月第15天的工作日”，即如果这个月第15天是周六，那么触发器将会在这个月第14天即周五触发；如果这个月第15天是周日，那么触发器将会在这个月第 16天即周一触发；如果这个月第15天是周二，那么就在触发器这天触发。注意一点：这个用法只会在当前月计算值，不会越过当前月。“W”字符仅能在 day-of-month指明一天，不能是一个范围或列表。也可以用“LW”来指定这个月的最后一个工作日。
- `#`：只能用在`星期`字段。用来指定这个月的第几个周几。例：在`星期`字段用"6#3"指这个月第3个周五（6指周五，3指第3个）。如果指定的日期不存在，触发器就不会触发。
- `C`：C是calendar意思，本字段只出现在`星期`字段和`日期`字段。代表一周的第几天，或者是一个月的第几天。写法如`3C`，在`星期`字段则代表一周第三天即为星期二（周日算第一天）,在`日期`字段，则代表每月第二天。

**关于`'?'`**
以前我总是困惑，觉得`'?'`表示不考虑该字段，那就表示取任意值都可以呗，而取任意值用`*`表示，总纠结于这两者的区别。从上面`字段含义`列表中我们可以看出`'?'`只在`日期`字段和`星期`字段出现才明白其中道理。日期字段和星期字段本来就有意思上的冲突，比如一个表达式日期字段上是`'*'`，代表每天都执行，星期字段上是`'2'`代表每个周二执行，问题就来了，到底是每天都执行呢，还是仅周二执行呢。所以这两个字段始终会有一个字段忽略不考虑，总结出一个规律，每个表达式中`日期`和`星期`两个字段中必然有一个的取值是`'?'`

##    案例

| 表达式 | 意义 |
| :-------- |: -------- |
| `0 0 12 * * ?`  | 每天中午12点触发
| `0 15 10 ? * *` | 每天上午10:15触发
| `0 15 10 * * ?` | 每天上午10:15触发
| `0 15 10 * * ? *` | 每天上午10:15触发
| `0 15 10 * * ? 2005` | 2005年的每天上午10:15触发
| `0 * 14 * * ?` | 在每天下午2点到下午2:59期间的每1分钟触发
| `0 0/5 14 * * ?` | 在每天下午2点到下午2:55期间的每5分钟触发
| `0 0/5 14,18 * * ?`  | 在每天下午2点到2:55期间和下午6点到6:55期间的每5分钟触发
| `0 0-5 14 * * ?` | 在每天下午2点到下午2:05期间的每1分钟触发
| `0 10,44 14 ? 3 WED` | 每年三月的星期三的下午2:10和2:44触发
| `0 15 10 ? * MON-FRI` | 周一至周五的上午10:15触发
| `0 15 10 15 * ?`  | 每月15日上午10:15触发
| `0 15 10 L * ?` | 每月最后一日的上午10:15触发
| `0 15 10 ? * 6L` | 每月的最后一个星期五上午10:15触发
| `0 15 10 ? * 6L 2002-2005` | 2002年至2005年的每月的最后一个星期五上午10:15触发
| `0 15 10 ? * 6#3` | 每月的第三个星期五上午10:15触发
| `0 15 10 ? * 6C` | 每周五上午10:15触发      
 
##   在线工具
使用[在线工具](http://cron.qqe2.com/)，帮助我们检测自己的表达式。输入表达式，反解析执行时间，如果没有解析出预期结果，说明表达式有问题



